{
  "code": "import { lwg } from \"../Lwg_Template/lwg\";\r\nimport UIMain_Gold from './UIMain_Gold';\r\nexport default class UITask extends Laya.Script {\r\n    constructor() { super(); }\r\n    onEnable() {\r\n        this.self = this.owner;\r\n        this.TaskTime = this.self['TaskTime'];\r\n        this.Describe = this.self['Describe'];\r\n        this.TaskNum = this.self['TaskNum'];\r\n        this.TaskContent = this.self['TaskContent'];\r\n        this.TaskLine = this.self['TaskLine'];\r\n        this.TaskCircle = this.self['TaskCircle'];\r\n        this.self['UITask'] = this;\r\n        this.self = this.owner;\r\n        this.sontentSet();\r\n    }\r\n    sontentSet() {\r\n        console.log('重来');\r\n        let num = lwg.Global._taskPreNum;\r\n        if (num > lwg.Global._taskContentArray.length) {\r\n            return;\r\n        }\r\n        let task = lwg.Global._taskContentArray[num - 1];\r\n        switch (task['type']) {\r\n            case lwg.Enum.TaskType.continue:\r\n                this.TaskLine.visible = false;\r\n                this.TaskCircle.visible = false;\r\n                this.TaskTime.visible = true;\r\n                this.TaskTime.text = task['time'] + 's';\r\n                lwg.Global._taskPreTime = task['time'] + 's';\r\n                lwg.Global._taskGoldBoo = false;\r\n                break;\r\n            case lwg.Enum.TaskType.topUp:\r\n                this.TaskLine.visible = true;\r\n                lwg.Global._taskPreTopY = this.TaskLine.y;\r\n                lwg.Global._taskPreTopYNum = 0;\r\n                this.TaskCircle.visible = false;\r\n                this.TaskTime.visible = false;\r\n                lwg.Global._taskGoldBoo = false;\r\n                break;\r\n            case lwg.Enum.TaskType.move:\r\n                this.TaskLine.visible = false;\r\n                this.TaskCircle.visible = true;\r\n                let randomX = this.TaskCircle.width / 2 + (Laya.stage.width - this.TaskCircle.width) * Math.random();\r\n                this.TaskCircle.x = randomX;\r\n                lwg.Global._taskPrePoint.x = this.TaskCircle.x;\r\n                let randomY = 50 * Math.random();\r\n                this.TaskCircle.y -= randomY;\r\n                lwg.Global._taskPrePoint.y = this.TaskCircle.y + this.self.y;\r\n                this.createCountDown();\r\n                console.log('移动任务来一次', this.drawPie);\r\n                this.TaskTime.visible = false;\r\n                lwg.Global._taskGoldBoo = false;\r\n                break;\r\n            case lwg.Enum.TaskType.gold:\r\n                this.TaskLine.visible = false;\r\n                this.TaskCircle.visible = false;\r\n                this.TaskTime.visible = true;\r\n                this.TaskTime.text = task['time'] + 's';\r\n                lwg.Global._taskPreTime = task['time'] + 's';\r\n                lwg.Global._taskGoldBoo = true;\r\n                this.goldLevelSet();\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        this.TaskContent.text = task['dec'];\r\n        let tasklen = lwg.Global._taskContentArray.length;\r\n        this.TaskNum.text = '[' + (num) + '/' + tasklen + ']';\r\n        lwg.Global._taskPreType = task['type'];\r\n        console.log('新的任务是:' + lwg.Global._taskPreType);\r\n        this.taskPromptStyle();\r\n    }\r\n    taskPromptStyle() {\r\n        let len = this.TaskContent.text.length;\r\n        if (len > 10) {\r\n            let baseboard = this.Describe.getChildByName('baseboard');\r\n            baseboard.width = 435;\r\n            this.Describe.x = 142;\r\n        }\r\n        else {\r\n            let baseboard = this.Describe.getChildByName('baseboard');\r\n            baseboard.width = 360;\r\n            this.Describe.x = 179;\r\n        }\r\n    }\r\n    createCountDown() {\r\n        this.CountDown = new Laya.Sprite();\r\n        this.CountDown.loadImage('youxi/ui_comp.png');\r\n        this.TaskCircle.addChild(this.CountDown);\r\n        this.CountDown.width = 154;\r\n        this.CountDown.height = 154;\r\n        this.CountDown.pivotX = 77;\r\n        this.CountDown.pivotY = 77;\r\n        this.CountDown.x = 77;\r\n        this.CountDown.y = 77;\r\n        this.drawPie = lwg.Tools.drawPieMask(this.CountDown, 0, 360);\r\n    }\r\n    goldLevelSet() {\r\n        let goldTem = lwg.Global.UIMain['UIMain'].goldTem;\r\n        for (let i = 0; i < 4; i++) {\r\n            for (let j = 0; j < 10; j++) {\r\n                let gold = goldTem.clone();\r\n                let GoldParent = lwg.Global.UIMain['UIMain'].GoldParent;\r\n                GoldParent.addChild(gold);\r\n                gold.transform.localPositionX = goldTem.transform.localPositionX - j * 0.063;\r\n                gold.transform.localPositionY = goldTem.transform.localPositionY - i * 0.063;\r\n                gold.addComponent(UIMain_Gold);\r\n                let goldColl = gold.getComponent(Laya.PhysicsCollider);\r\n                goldColl.isTrigger = true;\r\n            }\r\n        }\r\n        lwg.Global._taskGoldNum = 0;\r\n    }\r\n    onUpdate() {\r\n        this.TaskTime.text = lwg.Global._taskPreTime;\r\n        if (!lwg.Global._gameStart) {\r\n            this.self.close();\r\n        }\r\n    }\r\n}\r\n",
  "references": [
    "D:/Game/project/SetBroom/Setbroom/src/script/Lwg_Template/lwg.ts",
    "D:/Game/project/SetBroom/Setbroom/src/script/Game/UIMain_Gold.ts"
  ]
}
