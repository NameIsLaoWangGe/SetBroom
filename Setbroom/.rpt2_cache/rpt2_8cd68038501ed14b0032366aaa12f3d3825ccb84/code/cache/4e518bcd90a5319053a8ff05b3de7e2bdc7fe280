{
  "code": "import { lwg } from \"../Lwg_Template/lwg\";\r\nimport ADManager from \"../../TJ/Admanager\";\r\nimport RecordManager from \"../../TJ/RecordManager\";\r\nexport default class UIPifuTry extends Laya.Script {\r\n    constructor() { super(); }\r\n    onEnable() {\r\n        this.self = this.owner;\r\n        this.PifuName = this.self['PifuName'];\r\n        this.Pifu = this.self['Pifu'];\r\n        this.BtnSelect = this.self['BtnSelect'];\r\n        this.BtnAdv = this.self['BtnAdv'];\r\n        this.BtnZanshi = this.self['BtnZanshi'];\r\n        this.Name = this.self['Name'];\r\n        this.randomNoHave();\r\n        this.btnClickOn();\r\n        this.adaptive();\r\n        this.openAni();\r\n    }\r\n    adaptive() {\r\n        this.self['SceneContent'].y = Laya.stage.height / 2;\r\n        this.self['P201_02'].y = Laya.stage.height * 0.1656;\r\n        this.self['P201_01'].y = Laya.stage.height * 0.1656;\r\n    }\r\n    openAni() {\r\n        let delayed = 150;\r\n        let time = 250;\r\n        let y1 = this.self['background'].y;\r\n        lwg.Animation.move_Deform_Y(this.self['background'], -300, -15, y1, -0.1, 0.2, time, delayed, f => {\r\n        });\r\n        let y2 = this.self['SceneContent'].y;\r\n        lwg.Animation.move_Deform_Y(this.self['SceneContent'], 1600, 15, y2, -0.1, 0.2, time, delayed * 2, f => {\r\n            lwg.Animation.swell_shrink(this.self['SetBtn'], 1, 1.1, time / 2, delayed * 3, f => {\r\n                this.btnClickOn();\r\n            });\r\n            lwg.Animation.swell_shrink(this.PifuName, 1, 1.1, time / 2, delayed * 2, f => {\r\n            });\r\n            lwg.Animation.swell_shrink(this.Pifu, 1, 1.1, time / 2, delayed * 1, f => {\r\n            });\r\n        });\r\n    }\r\n    noHaveSubChaoren() {\r\n        let allArray = [];\r\n        for (let i = 0; i < lwg.Global._allPifu.length; i++) {\r\n            const element = lwg.Global._allPifu[i];\r\n            allArray.push(element);\r\n        }\r\n        for (let j = 0; j < allArray.length; j++) {\r\n            let element1 = allArray[j];\r\n            for (let k = 0; k < lwg.Global._havePifu.length; k++) {\r\n                let element2 = lwg.Global._havePifu[k];\r\n                if (element1 === element2) {\r\n                    allArray.splice(j, 1);\r\n                    j--;\r\n                }\r\n            }\r\n        }\r\n        lwg.Global._notHavePifu = allArray;\r\n        for (let k = 0; k < allArray.length; k++) {\r\n            const element = allArray[k];\r\n            if (element === '09_chaoren') {\r\n                allArray.splice(k, 1);\r\n            }\r\n            lwg.Global._notHavePifuSubChaoren = allArray;\r\n            console.log(lwg.Global._notHavePifuSubChaoren);\r\n        }\r\n    }\r\n    randomNoHave() {\r\n        let len = lwg.Global._notHavePifuSubChaoren.length;\r\n        if (len === 0) {\r\n            this.self.close();\r\n            lwg.Global._gameStart = true;\r\n            return;\r\n        }\r\n        let random = Math.floor(Math.random() * len);\r\n        let pifuName = lwg.Global._notHavePifu[random];\r\n        let oder1 = lwg.Enum.PifuAllName[pifuName];\r\n        this.pifuNum = oder1;\r\n        this.Name.text = lwg.Enum.PifuAllName_Ch[oder1];\r\n        let pifuImg = this.Pifu.getChildByName('img');\r\n        let oder2 = lwg.Enum.PifuAllName[pifuName];\r\n        pifuImg.skin = lwg.Enum.PifuSkin[oder2];\r\n    }\r\n    btnClickOn() {\r\n        lwg.Click.on(lwg.Click.ClickType.noEffect, null, this.self['BtnSelect'], this, null, null, this.btnSelectUp, null);\r\n        lwg.Click.on('largen', null, this.self['BtnAdv'], this, null, null, this.btnAdvClickUp, null);\r\n    }\r\n    btnCloseClickUp(event) {\r\n        event.currentTarget.scale(1, 1);\r\n        this.self.close();\r\n        lwg.Global._gameStart = true;\r\n    }\r\n    btnSelectUp() {\r\n        let dot = this.self['BtnSelect'].getChildByName('Dot');\r\n        let url1 = 'pifushiyong/word_shiyong.png';\r\n        let url2 = 'pifushiyong/word_zanshino.png';\r\n        let word = this.self['BtnAdv'].getChildByName('Word');\r\n        if (dot.visible) {\r\n            word.skin = url2;\r\n            dot.visible = false;\r\n        }\r\n        else {\r\n            word.skin = url1;\r\n            dot.visible = true;\r\n        }\r\n    }\r\n    btnAdvClickUp(event) {\r\n        event.currentTarget.scale(1, 1);\r\n        let dot = this.self['BtnSelect'].getChildByName('Dot');\r\n        if (dot.visible) {\r\n            ADManager.ShowReward(() => {\r\n                this.advFunc();\r\n            });\r\n        }\r\n        else {\r\n            this.self.close();\r\n            lwg.Global._gameStart = true;\r\n        }\r\n    }\r\n    advFunc() {\r\n        let yuanpifu = lwg.Global._currentPifu;\r\n        lwg.Global._currentPifu = lwg.Enum.PifuAllName[this.pifuNum];\r\n        lwg.Global.UIMain['UIMain'].currentPifuSet();\r\n        lwg.Global._currentPifu = yuanpifu;\r\n        lwg.LocalStorage.addData();\r\n        lwg.Global._gameStart = true;\r\n        this.self.close();\r\n    }\r\n    onDisable() {\r\n        RecordManager.startAutoRecord();\r\n    }\r\n}\r\n",
  "references": [
    "D:/Game/project/SetBroom/obj/Setbroom/src/script/Lwg_Template/lwg.ts",
    "D:/Game/project/SetBroom/obj/Setbroom/src/TJ/Admanager.ts",
    "D:/Game/project/SetBroom/obj/Setbroom/src/TJ/RecordManager.ts"
  ]
}
