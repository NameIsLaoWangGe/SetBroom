{
  "code": "import { ui } from \"./../ui/layaMaxUI\";\r\nimport Hand from \"./Hand\";\r\nimport Besom from \"./Besom\";\r\nimport GameControl from \"./GameControl\";\r\nexport default class GameUI extends ui.test.TestSceneUI {\r\n    constructor() {\r\n        super();\r\n        this.outs = new Array();\r\n        this.moveSwitch = false;\r\n        this.constraintComponent = new Laya.ConstraintComponent();\r\n        let selfScene = this.gameScene;\r\n        Laya.Sprite3D.load(\"testScene/LayaScene_GameMain/Conventional/GameMain.ls\", Laya.Handler.create(this, this.onComplete));\r\n        this._ray = new Laya.Ray(new Laya.Vector3(0, 0, 0), new Laya.Vector3(0, 0, 0));\r\n    }\r\n    onComplete(scene) {\r\n        Laya.stage.addChild(scene);\r\n        this.gameScene = scene;\r\n        this.gameScene.addComponent(GameControl);\r\n        this.camera = scene.getChildAt(0);\r\n        this.ground = scene.getChildAt(2);\r\n        this.person = scene.getChildAt(3);\r\n        this.rightHand = scene.getChildAt(4);\r\n        this.rightHand.addComponent(Hand);\r\n        this.rightHandRig = this.rightHand.getComponent(Laya.Rigidbody3D);\r\n        this.leftHand = scene.getChildAt(5);\r\n        this.leftHand.addComponent(Hand);\r\n        this.leftHandRig = this.leftHand.getComponent(Laya.Rigidbody3D);\r\n        this.besom = scene.getChildAt(6);\r\n        this.besom.addComponent(Besom);\r\n        this.besomRig = this.besom.getComponent(Laya.Rigidbody3D);\r\n        this.addMouseEvent();\r\n    }\r\n    addMouseEvent() {\r\n        Laya.stage.on(Laya.Event.MOUSE_DOWN, this, this.onMouseDown);\r\n        Laya.stage.on(Laya.Event.MOUSE_MOVE, this, this.onMouseMove);\r\n        Laya.stage.on(Laya.Event.MOUSE_UP, this, this.onMouseUp);\r\n        Laya.stage.on(Laya.Event.MOUSE_OUT, this, this.onMouseOut);\r\n    }\r\n    onMouseDown() {\r\n        this.firstX = Laya.MouseManager.instance.mouseX;\r\n        this.firstY = Laya.MouseManager.instance.mouseY;\r\n        this.camera.viewportPointToRay(new Laya.Vector2(this.firstX, this.firstY), this._ray);\r\n        this.gameScene.physicsSimulation.rayCastAll(this._ray, this.outs);\r\n        console.log(this.outs);\r\n        if (this.outs.length != 0) {\r\n            for (var i = 0; i < this.outs.length; i++) {\r\n                let hitResult = this.outs[i].collider.owner;\r\n                if (hitResult.name === 'leftHand' || hitResult.name === 'rightHand') {\r\n                    this.moveSwitch = true;\r\n                    if (hitResult.name === 'leftHand') {\r\n                        this.targetHand = this.leftHand;\r\n                    }\r\n                    else {\r\n                        this.targetHand = this.rightHand;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    onMouseMove() {\r\n        if (!this.moveSwitch) {\r\n            return;\r\n        }\r\n        let x = Laya.MouseManager.instance.mouseX;\r\n        let y = Laya.MouseManager.instance.mouseY;\r\n        let differenceX;\r\n        let differenceY;\r\n        if (this.firstX && this.firstY) {\r\n            differenceX = this.firstX - x;\r\n            differenceY = this.firstY - y;\r\n        }\r\n        else {\r\n            this.firstX = Laya.MouseManager.instance.mouseX;\r\n            this.firstY = Laya.MouseManager.instance.mouseY;\r\n            return;\r\n        }\r\n        let moveX = differenceX / 900;\r\n        let moveY = differenceY / 900;\r\n        this.firstX = x;\r\n        this.firstY = y;\r\n        let handPosition = new Laya.Vector3(moveX, moveY, 0);\r\n        let transformhand = this.targetHand.transform;\r\n        transformhand.translate(handPosition);\r\n        let connectSWicth = this.targetHand['Hand'].connectSWicth;\r\n        if (connectSWicth) {\r\n            let handX = this.targetHand.transform.localPositionX;\r\n            let besomX = this.besom.transform.localPositionX;\r\n            let differenceX = this.targetHand['Hand'].palm.transform.localScaleX * 2 / 5;\r\n            if (moveX > 0) {\r\n                this.besomRig.angularVelocity = (new Laya.Vector3(0, 0, -0.6));\r\n                this.besomRig.gravity = new Laya.Vector3(-0.1, -3, 0);\r\n            }\r\n            else if (moveX < 0) {\r\n                this.besomRig.angularVelocity = (new Laya.Vector3(0, 0, 0.6));\r\n                this.besomRig.gravity = new Laya.Vector3(0.1, -3, 0);\r\n            }\r\n            else if (moveX === 0) {\r\n                this.besomRig.angularVelocity = new Laya.Vector3(0, 0, 0);\r\n                this.besomRig.gravity = new Laya.Vector3(0, -3, 0);\r\n                this.besomRig.linearVelocity = new Laya.Vector3(0, 0, 0);\r\n            }\r\n            this.targetHand['Hand'].bottomPosition();\r\n        }\r\n    }\r\n    onMouseUp() {\r\n        this.moveSwitch = false;\r\n    }\r\n    onMouseOut() {\r\n        this.moveSwitch = false;\r\n    }\r\n}\r\n",
  "references": [
    "D:/Game/project/SetBroom/Setbroom/src/ui/layaMaxUI.ts",
    "D:/Game/project/SetBroom/Setbroom/src/script/Hand.ts",
    "D:/Game/project/SetBroom/Setbroom/src/script/Besom.ts",
    "D:/Game/project/SetBroom/Setbroom/src/script/GameControl.ts"
  ]
}
